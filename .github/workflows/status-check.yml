name: Status Check

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
  schedule:
    - cron: '0 */12 * * *'  # –ö–∞–∂–¥—ã–µ 12 —á–∞—Å–æ–≤

jobs:
  check-status:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout
      uses: actions/checkout@v4
      
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        cache: 'npm'
        
    - name: Install dependencies
      run: npm ci
      
    - name: Check dev server readiness
      run: |
        echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ dev —Å–µ—Ä–≤–µ—Ä–∞..."
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
        echo "üì¶ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π..."
        npm list --depth=0
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Å–∫—Ä–∏–ø—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã
        echo "üîß –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤..."
        npm run --silent dev --help || echo "Dev —Å–∫—Ä–∏–ø—Ç –Ω–∞–π–¥–µ–Ω"
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Next.js
        echo "‚öôÔ∏è –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Next.js..."
        if [ -f "next.config.ts" ]; then
          echo "‚úÖ next.config.ts –Ω–∞–π–¥–µ–Ω"
        else
          echo "‚ùå next.config.ts –Ω–µ –Ω–∞–π–¥–µ–Ω"
        fi
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã
        echo "üìÅ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞..."
        if [ -d "src/app" ]; then
          echo "‚úÖ src/app –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –Ω–∞–π–¥–µ–Ω–∞"
        else
          echo "‚ùå src/app –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
        fi
        
        if [ -f "package.json" ]; then
          echo "‚úÖ package.json –Ω–∞–π–¥–µ–Ω"
          echo "üìã –í–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞: $(node -p "require('./package.json').version")"
        else
          echo "‚ùå package.json –Ω–µ –Ω–∞–π–¥–µ–Ω"
        fi
        
        echo "‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!"
        
    - name: Create status page
      run: |
        mkdir -p public
        cat > public/index.html << 'EOF'
        <!DOCTYPE html>
        <html lang="ru">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Solar Studio Web - Status</title>
            <style>
                * { margin: 0; padding: 0; box-sizing: border-box; }
                body {
                    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    min-height: 100vh;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                }
                .container {
                    text-align: center;
                    max-width: 700px;
                    padding: 2rem;
                    background: rgba(255,255,255,0.1);
                    border-radius: 20px;
                    backdrop-filter: blur(10px);
                    box-shadow: 0 8px 32px rgba(0,0,0,0.3);
                }
                .status-badge {
                    display: inline-block;
                    background: #2ecc71;
                    color: white;
                    padding: 0.5rem 1rem;
                    border-radius: 25px;
                    font-weight: bold;
                    margin: 1rem 0;
                }
                .command-box {
                    background: rgba(0,0,0,0.3);
                    padding: 1.5rem;
                    border-radius: 15px;
                    margin: 1.5rem 0;
                    font-family: 'Courier New', monospace;
                    text-align: left;
                }
                .btn {
                    display: inline-block;
                    background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
                    color: white;
                    padding: 1rem 2rem;
                    text-decoration: none;
                    border-radius: 50px;
                    margin: 0.5rem;
                    transition: transform 0.3s ease;
                    font-weight: bold;
                }
                .btn:hover { transform: translateY(-2px); }
                .info-grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                    gap: 1rem;
                    margin: 2rem 0;
                }
                .info-card {
                    background: rgba(255,255,255,0.1);
                    padding: 1rem;
                    border-radius: 10px;
                    border-left: 4px solid #4ecdc4;
                }
            </style>
        </head>
        <body>
            <div class="container">
                <h1>üöÄ Solar Studio Web</h1>
                <p style="font-size: 1.2rem; margin: 1rem 0;">Next.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Å—Ç—É–¥–∏–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏–≥—Ä–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞</p>
                
                <div class="status-badge">‚úÖ –ì–æ—Ç–æ–≤ –∫ –∑–∞–ø—É—Å–∫—É</div>
                
                <div class="command-box">
                    <div><strong>–õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫:</strong></div>
                    <div>git clone https://github.com/YOUR_USERNAME/solar-studio-web.git</div>
                    <div>cd solar-studio-web</div>
                    <div>npm install</div>
                    <div>npm run dev</div>
                    <div style="margin-top: 1rem; color: #4ecdc4;">üåê –û—Ç–∫—Ä–æ–π—Ç–µ: http://localhost:4400</div>
                </div>
                
                <div class="info-grid">
                    <div class="info-card">
                        <h4>üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h4>
                        <p>–§–æ—Ä–º—ã –≤—Ö–æ–¥–∞ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</p>
                    </div>
                    <div class="info-card">
                        <h4>üë§ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h4>
                        <p>–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π dashboard</p>
                    </div>
                    <div class="info-card">
                        <h4>üõçÔ∏è –ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤</h4>
                        <p>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞</p>
                    </div>
                    <div class="info-card">
                        <h4>üì± –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å</h4>
                        <p>–†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö</p>
                    </div>
                </div>
                
                <div style="margin: 2rem 0;">
                    <a href="https://github.com/YOUR_USERNAME/solar-studio-web" class="btn" target="_blank">
                        üìÅ GitHub Repository
                    </a>
                    <a href="https://github.com/YOUR_USERNAME/solar-studio-web/actions" class="btn" target="_blank">
                        üîÑ GitHub Actions
                    </a>
                </div>
                
                <div style="font-size: 0.9rem; opacity: 0.8; margin-top: 2rem;">
                    <p>–ü–æ—Å–ª–µ–¥–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞: <span id="timestamp"></span></p>
                    <p>–°—Ç–∞—Ç—É—Å: Dev —Å–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –∫ –∑–∞–ø—É—Å–∫—É</p>
                </div>
            </div>
            
            <script>
                document.getElementById('timestamp').textContent = new Date().toLocaleString('ru-RU');
            </script>
        </body>
        </html>
        EOF
        
    - name: Deploy to GitHub Pages
      uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: ./public
